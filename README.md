# moreStats4GFFCompare
### Author: Daniel Kunk, 2025
Small script to extract counts for GFFcompare class codes and single/multi exon transcripts.

# gffcompare_qc.sh
This is a small tool to generate class code counts and also count single and multi exon transcripts from the files generated by running GFFcompare on a stringtie assembly RNAseq workflow.

## 1. Instructions
This script can be run as follows by running the script and passing the path to your .tmap file and your annotated.gtf file, both of which are generated by GFFcompare.

```
bash ./gffcompare_qc.sh \
    path/to/stringtiecompare.tmap \
    path/to/stringtiecompare.annotated.gtf
```
When an output file is not specified as is the case above, the stats will be written to a file called `stringtiecompare.qc_summary.txt` which will be placed in the directory where the .tmap and .gtf files are located. 

The output can be sent to stdout instead of a file as below.

```
bash ./gffcompare_qc.sh \
    path/to/stringtiecompare.tmap \
    path/to/stringtiecompare.annotated.gtf  -
```
Or it can be sent to a file of your chosing with the syntax below.

```
bash ./gffcompare_qc.sh \
    path/to/stringtiecompare.tmap \
    path/to/stringtiecompare.annotated.gtf \
    my_summary.txt
``` 

## 2. Output
The output file might look like something below.

```
=== gffcompare QC summary ===
Total transcripts          : 79 876
-----------------------------------
Class-code counts          ( =, j, u, … )
Code   Count
j      34 198
=      23 192
u       6 509
…

Mean transcript length by code (bp)
Code   MeanLen
=      2 015.4
j      1 432.7
u        998.7
…

Single-exon transcripts : 6 321
Multi-exon transcripts  : 73 555
```
- Class-code counts tell you how many transcripts perfectly match the reference (=), partially match (j, c), or are novel (u, x, etc.).

- Mean length by code shows the average size of each transcript (To-do: add median?).

# single_exon_transcripts.sh
This is a small tool to grab all single exon transcripts from the .tmap file generated by gffcompare and append them into a new tsv file with the same structure.

## 1. Instructions
```
bash single_exon_transcripts.sh   <stringtiecompare.tmap>  [out.tsv|-]
```

This script will list every transcript whose exon count is equal to 1.

If the 2nd argument is “-” the table is sent to stdout.
Otherwise it defaults to <tmap_basename>.single_exon.tsv.

## 2. Output

The output file will simply be a tsv file and should match the number of single exon transcripts as shown in the `gffcompare_qc.sh` script. 

```
qry_id  class_code  qry_gene_id  len  FPKM  TPM
...
```

Please report any bugs as an issue and cite this repo and my authorship if you use the tool. 
MIT LISENCE
